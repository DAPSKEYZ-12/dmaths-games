<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Arithmetic | Exam Prep</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=JetBrains+Mono:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .math-font { font-family: 'JetBrains Mono', monospace; }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
        .progress-bar { transition: width 1s linear; }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        .wrong { animation: shake 0.2s ease-in-out 0s 2; border-color: #ef4444 !important; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen flex items-center justify-center p-4 overflow-hidden">

    <a href="index.html" class="fixed top-6 left-6 z-50 bg-white shadow-md border border-slate-200 px-4 py-2 rounded-xl font-bold text-slate-600 hover:text-red-500 transition-colors">
        <i class="fas fa-times mr-2"></i> Exit
    </a>

    <div class="w-full max-w-lg">
        
        <div id="setup-screen" class="glass-card border border-slate-200 rounded-[2.5rem] p-8 shadow-xl text-center">
            <div class="w-20 h-20 bg-indigo-600 rounded-2xl flex items-center justify-center text-white text-4xl mx-auto mb-6 shadow-lg shadow-indigo-200">
                <i class="fas fa-bolt"></i>
            </div>
            <h1 class="text-3xl font-extrabold text-slate-900 mb-2">Speed Arithmetic</h1>
            <p class="text-slate-500 mb-8">Boost your accuracy for WAEC/UTME exams.</p>
            
            <div class="space-y-4 mb-8">
                <p class="text-xs font-bold text-indigo-600 uppercase tracking-widest">Select Level</p>
                <div class="grid grid-cols-3 gap-3">
                    <button onclick="setLevel('basic')" id="btn-basic" class="level-btn py-3 rounded-xl border-2 border-slate-100 font-bold hover:border-indigo-500 transition-all bg-white">Basic</button>
                    <button onclick="setLevel('ssce')" id="btn-ssce" class="level-btn py-3 rounded-xl border-2 border-indigo-500 bg-indigo-50 text-indigo-700 font-bold transition-all">SSCE</button>
                    <button onclick="setLevel('utme')" id="btn-utme" class="level-btn py-3 rounded-xl border-2 border-slate-100 font-bold hover:border-indigo-500 transition-all bg-white">UTME</button>
                </div>
            </div>

            <button onclick="startGame()" class="w-full py-4 bg-slate-900 text-white rounded-2xl font-bold text-lg hover:bg-indigo-600 transition-all shadow-xl">
                Start Challenge
            </button>
        </div>

        <div id="game-screen" class="hidden glass-card border border-slate-200 rounded-[2.5rem] p-6 shadow-xl relative overflow-hidden">
            <div class="absolute top-0 left-0 h-2 bg-indigo-500 progress-bar" id="timer-bar" style="width: 100%"></div>
            
            <div class="flex justify-between items-center mb-10 pt-4">
                <div class="text-left">
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Score</p>
                    <p class="text-2xl font-black text-slate-900" id="current-score">0</p>
                </div>
                <div class="text-right">
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Time Left</p>
                    <p class="text-2xl font-black text-indigo-600" id="timer-text">60s</p>
                </div>
            </div>

            <div class="text-center mb-12">
                <div id="question" class="math-font text-5xl md:text-6xl font-bold text-slate-800 tracking-tighter">
                    23 &times; 7
                </div>
            </div>

            <div class="relative mb-6">
                <input type="number" id="answer-input" placeholder="?" 
                    class="w-full bg-slate-100 border-2 border-transparent rounded-2xl py-6 text-center text-4xl font-black text-indigo-600 outline-none focus:border-indigo-500 transition-all"
                    autofocus>
                <p class="text-center text-slate-400 text-xs mt-4 font-semibold uppercase tracking-widest">Type & Hit Enter</p>
            </div>
        </div>

        <div id="result-screen" class="hidden glass-card border border-slate-200 rounded-[2.5rem] p-8 shadow-xl text-center">
            <h2 class="text-2xl font-black text-slate-900 mb-6">Challenge Ended</h2>
            <div class="bg-indigo-50 rounded-3xl p-6 mb-8">
                <p class="text-slate-500 font-bold text-sm uppercase">Your Final Score</p>
                <p class="text-6xl font-black text-indigo-600" id="final-score">0</p>
            </div>

            <div class="mb-8">
                <p class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-widest">Local High Scores</p>
                <div id="leaderboard" class="space-y-2">
                    </div>
            </div>

            <div class="flex gap-4">
                <button onclick="location.reload()" class="flex-1 py-4 bg-slate-100 text-slate-900 rounded-2xl font-bold hover:bg-slate-200 transition-all">Try Again</button>
                <a href="index.html" class="flex-1 py-4 bg-slate-900 text-white rounded-2xl font-bold hover:opacity-90 transition-all flex items-center justify-center">Exit</a>
            </div>
        </div>

    </div>

    <script>
        let score = 0;
        let timeLeft = 60;
        let timer = null;
        let currentAnswer = 0;
        let level = 'ssce';

        const setupScreen = document.getElementById('setup-screen');
        const gameScreen = document.getElementById('game-screen');
        const resultScreen = document.getElementById('result-screen');
        const input = document.getElementById('answer-input');

        function setLevel(l) {
            level = l;
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('border-indigo-500', 'bg-indigo-50', 'text-indigo-700');
                btn.classList.add('border-slate-100', 'bg-white');
            });
            event.target.classList.remove('border-slate-100', 'bg-white');
            event.target.classList.add('border-indigo-500', 'bg-indigo-50', 'text-indigo-700');
        }

        function startGame() {
            setupScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            score = 0;
            timeLeft = 60;
            nextQuestion();
            input.focus();
            
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer-text').innerText = timeLeft + 's';
                document.getElementById('timer-bar').style.width = (timeLeft / 60 * 100) + '%';
                
                if (timeLeft <= 0) endGame();
            }, 1000);
        }

        function nextQuestion() {
            let a, b, op;
            const ops = ['+', '-', '×'];
            op = ops[Math.floor(Math.random() * ops.length)];

            if (level === 'basic') {
                a = Math.floor(Math.random() * 20) + 1;
                b = Math.floor(Math.random() * 20) + 1;
            } else if (level === 'ssce') {
                a = Math.floor(Math.random() * 50) + 10;
                b = Math.floor(Math.random() * 30) + 5;
                if(op === '×') { a = Math.floor(Math.random()*15)+2; b = Math.floor(Math.random()*12)+2; }
            } else {
                a = Math.floor(Math.random() * 100) + 20;
                b = Math.floor(Math.random() * 100) + 20;
                if(op === '×') { a = Math.floor(Math.random()*25)+2; b = Math.floor(Math.random()*15)+2; }
            }

            if (op === '+') currentAnswer = a + b;
            if (op === '-') { 
                if (a < b) [a, b] = [b, a]; // Avoid negatives for speed
                currentAnswer = a - b; 
            }
            if (op === '×') currentAnswer = a * b;

            document.getElementById('question').innerHTML = `${a} <span class="text-indigo-500">${op}</span> ${b}`;
            input.value = '';
        }

        input.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                const val = parseInt(input.value);
                if (val === currentAnswer) {
                    score += (level === 'utme' ? 15 : level === 'ssce' ? 10 : 5);
                    document.getElementById('current-score').innerText = score;
                    nextQuestion();
                } else {
                    // Penalty
                    score = Math.max(0, score - 5);
                    document.getElementById('current-score').innerText = score;
                    input.classList.add('wrong');
                    setTimeout(() => input.classList.remove('wrong'), 300);
                    input.value = '';
                }
            }
        });

        function endGame() {
            clearInterval(timer);
            gameScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            document.getElementById('final-score').innerText = score;
            saveScore(score);
        }

        function saveScore(s) {
            let scores = JSON.parse(localStorage.getItem('arithmetic_ranks') || "[]");
            scores.push({s, d: new Date().toLocaleDateString(), l: level.toUpperCase()});
            scores.sort((a, b) => b.s - a.s);
            scores = scores.slice(0, 5);
            localStorage.setItem('arithmetic_ranks', JSON.stringify(scores));
            
            document.getElementById('leaderboard').innerHTML = scores.map((item, i) => `
                <div class="flex justify-between items-center bg-slate-50 p-3 rounded-xl border border-slate-100">
                    <span class="font-bold text-slate-500">#${i+1} <span class="ml-2 text-slate-900">${item.s}</span></span>
                    <span class="text-[10px] font-black bg-white px-2 py-1 rounded-md border border-slate-200">${item.l}</span>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
