<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geometry Quest: Circle Mastery</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #2c3e50; --secondary: #34495e; --accent: #e67e22; --success: #27ae60; --danger: #e74c3c; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #f0f2f5; color: var(--primary); padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 350px; gap: 20px; }
        header { grid-column: 1 / -1; background: var(--primary); color: white; padding: 20px; border-radius: 12px; text-align: center; }
        .main-card { background: white; padding: 25px; border-radius: 12px; shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .sidebar { background: white; padding: 20px; border-radius: 12px; }
        
        canvas { background: #fff; border: 2px solid #ddd; border-radius: 8px; width: 100%; max-width: 500px; margin: 0 auto; display: block; }
        
        .theorem-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin: 20px 0; }
        .t-btn { padding: 10px; border: 1px solid #ddd; border-radius: 6px; cursor: pointer; background: #f8f9fa; font-size: 0.85rem; font-weight: 600; transition: 0.2s; }
        .t-btn.active { background: var(--accent); color: white; border-color: var(--accent); }
        
        .info-box { background: #fff3e0; border-left: 5px solid var(--accent); padding: 15px; margin: 15px 0; border-radius: 4px; }
        .quiz-box { display: none; background: #e8f5e9; padding: 20px; border-radius: 8px; margin-top: 20px; }
        
        .option-btn { display: block; width: 100%; padding: 12px; margin: 8px 0; border: 2px solid #ced4da; border-radius: 6px; background: white; cursor: pointer; text-align: left; }
        .option-btn:hover { border-color: var(--accent); }
        
        .progress-container { margin: 15px 0; }
        .bar { background: #ddd; height: 10px; border-radius: 5px; overflow: hidden; }
        .fill { background: var(--success); height: 100%; width: 0%; transition: 0.5s; }
        
        .history-list { font-size: 0.9rem; max-height: 400px; overflow-y: auto; }
        .history-item { padding: 8px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1><i class="fas fa-shapes"></i> Circle Theorem Masterclass</h1>
        <p>Analyze the diagrams, understand the proofs, and solve the geometric puzzles.</p>
    </header>

    <div class="main-card">
        <canvas id="geoCanvas" width="500" height="400"></canvas>

        <div class="theorem-grid" id="buttonGrid">
            </div>

        <div id="explanationArea">
            <h2 id="tTitle">Central Angle</h2>
            <div class="info-box">
                <p id="tDesc"></p>
                <strong id="tLogic" style="display:block; margin-top:10px; color:#d35400;"></strong>
            </div>
        </div>

        <button class="t-btn" style="background:var(--primary); color:white; width:200px;" onclick="startQuiz()">
            <i class="fas fa-edit"></i> Solve Practice Problem
        </button>

        <div class="quiz-box" id="quizBox">
            <h3 id="qText">Question goes here?</h3>
            <div id="qOptions"></div>
        </div>
    </div>

    <div class="sidebar">
        <h3>Your Progress</h3>
        <div class="progress-container">
            <div class="bar"><div class="fill" id="progressFill"></div></div>
            <p style="font-size:0.8rem; margin-top:5px;">Mastery: <span id="masteryCount">0</span>/8 Theorems</p>
        </div>
        
        <div class="stats" style="margin: 20px 0;">
            <p>Score: <strong id="score">0</strong></p>
            <p>Best Streak: <strong id="streak">0</strong></p>
        </div>

        <h4>Activity Log</h4>
        <div class="history-list" id="history"></div>
    </div>
</div>

<script>
    const canvas = document.getElementById('geoCanvas');
    const ctx = canvas.getContext('2d');
    const center = { x: 250, y: 200 }, radius = 140;

    let gameState = {
        current: 'center',
        score: 0,
        streak: 0,
        mastered: new Set(),
        data: {
            center: {
                title: "Angle at Center & Circumference",
                desc: "The angle subtended by an arc at the center is exactly double the angle at the circumference.",
                logic: "Proof Hint: Drawing a line from the center to the top vertex creates two isosceles triangles. Use the exterior angle theorem!",
                problem: "If the top angle is 37°, what is the central angle?",
                options: ["18.5°", "74°", "90°", "148°"],
                ans: 1
            },
            semicircle: {
                title: "Angle in a Semicircle",
                desc: "Any angle drawn from the ends of a diameter to the circumference is a right angle (90°).",
                logic: "Proof Hint: This is a special case of the Center Theorem where the central angle is a straight line (180°).",
                problem: "In ΔABC, if AB is the diameter and ∠A = 30°, find ∠B.",
                options: ["30°", "60°", "90°", "120°"],
                ans: 1
            },
            cyclic: {
                title: "Cyclic Quadrilaterals",
                desc: "Opposite angles in a quadrilateral where all 4 points touch the circle sum to 180°.",
                logic: "Proof Hint: The two central angles formed by the diagonals sum to 360°, thus their halves (circumference angles) sum to 180°.",
                problem: "If ∠A = 115° in a cyclic quad, what is the value of the opposite ∠C?",
                options: ["65°", "75°", "115°", "180°"],
                ans: 0
            },
            tangent: {
                title: "Tangent-Radius Property",
                desc: "A tangent line touches the circle at exactly one point and is perpendicular to the radius.",
                logic: "Proof Hint: The radius is the shortest distance from the center to the line; shortest distance is always perpendicular.",
                problem: "A triangle is formed by Center O, Point P on circumference, and Point T. If OT is 13cm and radius is 5cm, find Tangent PT.",
                options: ["8cm", "10cm", "12cm", "18cm"],
                ans: 2
            }
        }
    };

    function draw() {
        ctx.clearRect(0,0,500,400);
        // Circle
        ctx.beginPath(); ctx.arc(center.x, center.y, radius, 0, Math.PI*2);
        ctx.strokeStyle = "#34495e"; ctx.lineWidth = 3; ctx.stroke();
        // Center Point
        ctx.beginPath(); ctx.arc(center.x, center.y, 4, 0, Math.PI*2); ctx.fill();

        ctx.lineWidth = 2;
        const p1 = { x: center.x + radius*Math.cos(0.8), y: center.y + radius*Math.sin(0.8) };
        const p2 = { x: center.x + radius*Math.cos(2.3), y: center.y + radius*Math.sin(2.3) };
        const top = { x: center.x + radius*Math.cos(-1.5), y: center.y + radius*Math.sin(-1.5) };

        switch(gameState.current) {
            case 'center':
                line(p1, center, "#3498db"); line(p2, center, "#3498db");
                line(p1, top, "#e74c3c"); line(p2, top, "#e74c3c");
                ctx.fillStyle = "#3498db"; ctx.fillText("2x", center.x-10, center.y+20);
                ctx.fillStyle = "#e74c3c"; ctx.fillText("x", top.x-5, top.y-10);
                break;
            case 'semicircle':
                const opp = { x: center.x + radius*Math.cos(0.8 + Math.PI), y: center.y + radius*Math.sin(0.8 + Math.PI) };
                line(p1, opp, "#3498db"); line(p1, top, "#e74c3c"); line(opp, top, "#e74c3c");
                ctx.fillText("90°", top.x-10, top.y+25);
                break;
            case 'cyclic':
                const p4 = { x: center.x + radius*Math.cos(4), y: center.y + radius*Math.sin(4) };
                ctx.beginPath(); ctx.moveTo(p1.x,p1.y); ctx.lineTo(top.x,top.y); ctx.lineTo(p2.x,p2.y); ctx.lineTo(p4.x,p4.y); ctx.closePath();
                ctx.strokeStyle = "#e67e22"; ctx.stroke();
                break;
            case 'tangent':
                line(center, p1, "#3498db");
                ctx.beginPath(); ctx.moveTo(p1.x-60, p1.y+45); ctx.lineTo(p1.x+60, p1.y-45);
                ctx.strokeStyle = "#e74c3c"; ctx.stroke();
                break;
        }
    }

    function line(f, t, col) {
        ctx.beginPath(); ctx.strokeStyle = col; ctx.moveTo(f.x, f.y); ctx.lineTo(t.x, t.y); ctx.stroke();
    }

    function init() {
        const grid = document.getElementById('buttonGrid');
        Object.keys(gameState.data).forEach(key => {
            const b = document.createElement('button');
            b.className = 't-btn';
            b.innerText = gameState.data[key].title;
            b.onclick = () => selectTheorem(key, b);
            grid.appendChild(b);
        });
        selectTheorem('center', grid.firstChild);
    }

    function selectTheorem(key, btn) {
        gameState.current = key;
        document.querySelectorAll('.t-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('quizBox').style.display = 'none';
        
        const d = gameState.data[key];
        document.getElementById('tTitle').innerText = d.title;
        document.getElementById('tDesc').innerText = d.desc;
        document.getElementById('tLogic').innerText = d.logic;
        draw();
    }

    function startQuiz() {
        const d = gameState.data[gameState.current];
        const box = document.getElementById('quizBox');
        box.style.display = 'block';
        document.getElementById('qText').innerText = d.problem;
        const opts = document.getElementById('qOptions');
        opts.innerHTML = '';
        
        d.options.forEach((o, i) => {
            const b = document.createElement('button');
            b.className = 'option-btn';
            b.innerText = o;
            b.onclick = () => checkAns(i);
            opts.appendChild(b);
        });
        box.scrollIntoView({behavior: "smooth"});
    }

    function checkAns(idx) {
        const correct = gameState.data[gameState.current].ans === idx;
        const hist = document.getElementById('history');
        const item = document.createElement('div');
        item.className = 'history-item';
        
        if(correct) {
            gameState.score += 20;
            gameState.streak++;
            gameState.mastered.add(gameState.current);
            item.innerHTML = `<span>Correct: ${gameState.current}</span> ✅`;
        } else {
            gameState.streak = 0;
            item.innerHTML = `<span>Failed: ${gameState.current}</span> ❌`;
        }
        
        updateStats();
        hist.prepend(item);
        document.getElementById('quizBox').style.display = 'none';
    }

    function updateStats() {
        document.getElementById('score').innerText = gameState.score;
        document.getElementById('streak').innerText = gameState.streak;
        const mCount = gameState.mastered.size;
        document.getElementById('masteryCount').innerText = mCount;
        document.getElementById('progressFill').style.width = (mCount / 8 * 100) + "%";
    }

    init();
</script>
</body>
</html>
