<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathPortal | Interactive Learning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: '#0f172a',
                        darker: '#020617',
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; transition: background-color 0.3s ease; }
        .glass-nav { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(12px); }
        .dark .glass-nav { background: rgba(15, 23, 42, 0.8); border-bottom: 1px solid rgba(255,255,255,0.05); }
        .game-card { transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .game-card:hover { transform: scale(1.03) translateY(-12px); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15); }
        .math-pattern { background-color: #f8fafc; background-image: radial-gradient(#cbd5e1 0.5px, transparent 0.5px); background-size: 30px 30px; }
        .dark .math-pattern { background-color: #020617; background-image: radial-gradient(#1e293b 0.5px, transparent 0.5px); }
        .hero-gradient { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); }
        .filter-btn.active { background-color: #6366f1; color: white; border-color: #6366f1; }
        #mobile-menu { transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .locked .app-protected { display: none; }
    </style>
</head>
<body class="math-pattern text-slate-900 dark:text-slate-100 min-h-screen locked">

    <div id="loginGate" class="fixed inset-0 z-[90] bg-slate-950/70 backdrop-blur-md flex items-center justify-center px-4">
        <div class="w-full max-w-md bg-white dark:bg-slate-900 rounded-3xl p-8 border border-slate-200 dark:border-slate-700 shadow-2xl">
            <p class="text-xs font-black uppercase tracking-[0.3em] text-indigo-500 mb-3">Secure Access</p>
            <h2 class="text-3xl font-extrabold mb-3">Login to Enter Home</h2>
            <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Login with your username and password, or sign up if this is your first time.</p>

            <div class="grid grid-cols-2 gap-2 mb-5 rounded-2xl bg-slate-100 dark:bg-slate-800 p-1 text-sm font-bold">
                <button type="button" id="showLoginBtn" class="auth-tab py-2 rounded-xl bg-white dark:bg-slate-700 text-indigo-600">Login</button>
                <button type="button" id="showSignupBtn" class="auth-tab py-2 rounded-xl text-slate-500 dark:text-slate-300">Sign Up</button>
            </div>

            <form id="loginForm" class="space-y-4" novalidate>
                <label for="loginUsername" class="sr-only">Username</label>
                <input id="loginUsername" type="text" placeholder="Username" minlength="3" maxlength="24" autocomplete="username" required class="w-full px-4 py-3 rounded-2xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500">
                <label for="loginPassword" class="sr-only">Password</label>
                <input id="loginPassword" type="password" placeholder="Password" minlength="6" autocomplete="current-password" required class="w-full px-4 py-3 rounded-2xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500">
                <button type="submit" class="w-full py-3 rounded-2xl bg-indigo-600 text-white font-bold hover:bg-indigo-500 transition">Login & Enter</button>
            </form>

            <form id="signupForm" class="space-y-4 hidden" novalidate>
                <label for="signupEmail" class="sr-only">Email</label>
                <input id="signupEmail" type="email" placeholder="Email" autocomplete="email" required class="w-full px-4 py-3 rounded-2xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500">
                <label for="signupUsername" class="sr-only">Username</label>
                <input id="signupUsername" type="text" placeholder="Username" minlength="3" maxlength="24" autocomplete="username" required class="w-full px-4 py-3 rounded-2xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500">
                <label for="signupPassword" class="sr-only">Password</label>
                <input id="signupPassword" type="password" placeholder="Password" minlength="6" autocomplete="new-password" required class="w-full px-4 py-3 rounded-2xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500">
                <label for="signupConfirmPassword" class="sr-only">Confirm password</label>
                <input id="signupConfirmPassword" type="password" placeholder="Confirm password" minlength="6" autocomplete="new-password" required class="w-full px-4 py-3 rounded-2xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 outline-none focus:ring-2 focus:ring-indigo-500">
                <button type="submit" class="w-full py-3 rounded-2xl bg-emerald-600 text-white font-bold hover:bg-emerald-500 transition">Create Account</button>
            </form>

            <p id="authError" class="hidden mt-4 text-sm text-rose-600 dark:text-rose-400 font-semibold"></p>
        </div>
    </div>

    <button id="menu-overlay" type="button" aria-label="Close menu" class="app-protected fixed inset-0 bg-black/40 z-[60] hidden backdrop-blur-sm"></button>

    <div id="mobile-menu" class="app-protected fixed top-0 right-0 h-full w-[85%] max-w-sm bg-white dark:bg-dark z-[70] translate-x-full shadow-2xl flex flex-col p-6">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-xl font-extrabold">Settings & Search</h2>
            <button id="close-menu-btn" type="button" aria-label="Close settings menu" class="w-10 h-10 flex items-center justify-center rounded-full bg-slate-100 dark:bg-slate-800 text-2xl">&times;</button>
        </div>

        <div class="space-y-4">
            <p class="text-xs font-bold uppercase tracking-widest text-slate-400">Quick Find</p>
            <div class="relative">
                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                <label for="mobileSearch" class="sr-only">Search challenges</label>
                <input type="text" id="mobileSearch" placeholder="Search challenges..." 
                    class="w-full pl-12 pr-4 py-4 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500">
            </div>
            
            <div class="pt-6">
                <p class="text-xs font-bold uppercase tracking-widest text-slate-400 mb-4">Stats</p>
                <div class="p-4 bg-indigo-50 dark:bg-indigo-950/30 text-indigo-700 dark:text-indigo-400 rounded-2xl flex justify-between items-center">
                    <span class="font-bold">Active Modules</span>
                    <span class="text-xl font-black">17</span>
                </div>
            </div>

            <div class="pt-6 border-t border-slate-200 dark:border-slate-800 space-y-3">
                <p class="text-xs font-bold uppercase tracking-widest text-slate-400">Dashboard Tools</p>
                <a href="#leaderboardPanel" class="block p-4 rounded-2xl bg-slate-50 dark:bg-slate-800/60 hover:bg-slate-100 dark:hover:bg-slate-800 transition">
                    <p class="font-bold">Leader Board</p>
                    <p class="text-xs text-slate-500 dark:text-slate-400">View top game scores quickly.</p>
                </a>
                <a href="#aiGuidePanel" class="block p-4 rounded-2xl bg-slate-50 dark:bg-slate-800/60 hover:bg-slate-100 dark:hover:bg-slate-800 transition">
                    <p class="font-bold">A.I Guide</p>
                    <p class="text-xs text-slate-500 dark:text-slate-400">Open solution hints and strategies.</p>
                </a>
            </div>
        </div>
    </div>

    <nav class="app-protected glass-nav sticky top-0 z-50 border-b border-slate-200">
        <div class="max-w-7xl mx-auto px-6 h-20 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 hero-gradient rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-lg shadow-indigo-500/20">π</div>
                <span class="text-2xl font-extrabold tracking-tight dark:text-white">DMaths-Games</span>
            </div>
            
            <div class="flex items-center gap-3">
                <button id="theme-toggle-btn" type="button" aria-label="Toggle dark mode" class="p-3 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:ring-2 ring-indigo-500 transition-all">
                    <i id="theme-icon" class="fas fa-moon"></i>
                </button>

                <button id="open-menu-btn" type="button" aria-label="Open settings menu" class="p-3 rounded-xl bg-indigo-600 text-white shadow-lg shadow-indigo-200 dark:shadow-none">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <header class="app-protected max-w-7xl mx-auto px-6 pt-16 pb-8 text-center">
        <span class="inline-block px-4 py-1.5 mb-6 text-sm font-bold tracking-widest text-indigo-600 dark:text-indigo-400 uppercase bg-indigo-50 dark:bg-indigo-900/20 rounded-full">Ready to Play?</span>
        <h1 class="text-5xl md:text-7xl font-extrabold mb-8 tracking-tight">
            Select Your <span class="text-transparent bg-clip-text hero-gradient">Challenge</span>
        </h1>

        <div class="max-w-2xl mx-auto space-y-6">
            <div class="relative group hidden md:block">
                <i class="fas fa-search absolute left-5 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500 transition-colors"></i>
                <label for="gameSearch" class="sr-only">Search for a math topic</label>
                <input type="text" id="gameSearch" placeholder="Search for a topic (e.g. Algebra)..." 
                    class="w-full pl-14 pr-6 py-4 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-sm focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all dark:text-white">
            </div>

            <div class="flex flex-wrap justify-center gap-2">
                <button type="button" data-category="all" class="filter-btn active px-5 py-2 rounded-full border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 text-sm font-bold hover:border-indigo-500 transition-all">All</button>
                <button type="button" data-category="arithmetic" class="filter-btn px-5 py-2 rounded-full border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 text-sm font-bold hover:border-indigo-500 transition-all">Arithmetic</button>
                <button type="button" data-category="algebra" class="filter-btn px-5 py-2 rounded-full border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 text-sm font-bold hover:border-indigo-500 transition-all">Algebra</button>
                <button type="button" data-category="geometry" class="filter-btn px-5 py-2 rounded-full border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 text-sm font-bold hover:border-indigo-500 transition-all">Geometry</button>
                <button type="button" data-category="logic" class="filter-btn px-5 py-2 rounded-full border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 text-sm font-bold hover:border-indigo-500 transition-all">Logic & Algorithms</button>
            </div>
        </div>
    </header>

    <section class="app-protected max-w-7xl mx-auto px-6 pb-10">
        <div class="grid lg:grid-cols-2 gap-6">
            <article id="leaderboardPanel" class="bg-white dark:bg-slate-900 rounded-3xl p-6 border border-slate-100 dark:border-slate-800 shadow-lg scroll-mt-24">
                <div class="flex items-center justify-between mb-5">
                    <h2 class="text-2xl font-extrabold">Leaders Board</h2>
                    <span class="text-xs uppercase tracking-widest font-bold text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 px-3 py-1 rounded-full">High Scores</span>
                </div>
                <div id="leaderboardList" class="space-y-3 text-sm"></div>
            </article>

            <article id="aiGuidePanel" class="bg-white dark:bg-slate-900 rounded-3xl p-6 border border-slate-100 dark:border-slate-800 shadow-lg scroll-mt-24">
                <div class="flex items-center justify-between mb-5">
                    <h2 class="text-2xl font-extrabold">AI Solution Coach</h2>
                    <span class="text-xs uppercase tracking-widest font-bold text-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 px-3 py-1 rounded-full">Predictions</span>
                </div>
                <div id="aiPredictionList" class="space-y-3 text-sm max-h-80 overflow-auto pr-1"></div>
            </article>
        </div>
    </section>

    <main class="app-protected max-w-7xl mx-auto px-6 pb-24">
        <div id="gameGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 transition-all duration-500">

          <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="arithmetic">
    <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-cyan-900 to-slate-900 flex flex-col items-center justify-center text-white relative overflow-hidden border border-cyan-500/30">
        <div class="absolute inset-0 opacity-10" style="background-image: conic-gradient(from 0deg, transparent, #06b6d4, transparent); animation: spin 4s linear infinite;"></div>
        
        <div class="z-10 grid grid-cols-3 gap-1 mb-2">
            <script>
                for(let i=0; i<9; i++) {
                    const op = [0.5, 1, 0.5, 1, 0.2, 1, 0.5, 1, 0.5][i];
                    document.write(`<div class="w-4 h-4 rounded-sm bg-cyan-500" style="opacity: ${op}"></div>`);
                }
            </script>
        </div>
        
        <div class="z-10 mono text-[9px] font-black text-cyan-400 uppercase tracking-[0.4em]">Protocol Lo Shu</div>
    </div>
    <div class="px-2">
        <span class="text-[10px] font-bold text-cyan-600 dark:text-cyan-400 uppercase tracking-widest bg-cyan-50 dark:bg-cyan-900/20 px-3 py-1 rounded-full">Arithmetic Balance</span>
        <h3 class="text-2xl font-bold mt-3 mb-2">Magic Square</h3>
        <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2 leading-relaxed">Balance the grid so every row, column, and diagonal matches the magic constant.</p>
        <a href="magic.html" class="flex items-center justify-center w-full py-4 bg-cyan-600 text-white rounded-2xl font-bold hover:bg-cyan-500 transition-all shadow-lg shadow-cyan-200 dark:shadow-none">
            <i class="fas fa-cube mr-2 text-xs"></i> Enter Protocol
        </a>
    </div>
</div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="logic">
    <div class="rounded-3xl h-44 mb-6 bg-gradient-to-tr from-indigo-900 via-slate-900 to-amber-900 flex flex-col items-center justify-center text-white relative overflow-hidden border border-indigo-500/30">
        <div class="absolute inset-0 opacity-20" style="background-image: linear-gradient(#334155 1px, transparent 1px), linear-gradient(90deg, #334155 1px, transparent 1px); background-size: 10px 10px;"></div>
        <i class="fas fa-table-cells text-5xl text-indigo-400 z-10 drop-shadow-[0_0_15px_rgba(99,102,241,0.5)]"></i>
        <div class="z-10 mt-3 mono text-[9px] font-black text-amber-500 uppercase tracking-[0.4em]">Elimination Strategy</div>
    </div>
    <div class="px-2">
        <span class="text-[10px] font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-widest bg-indigo-50 dark:bg-indigo-900/20 px-3 py-1 rounded-full">Logic Puzzle</span>
        <h3 class="text-2xl font-bold mt-3 mb-2">Deduction Protocol</h3>
        <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2 leading-relaxed">Ayo doesn't study Algebra. The UTME student is not Musa. Use the grid to solve the master puzzle.</p>
        <a href="logic.html" class="flex items-center justify-center w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold hover:bg-indigo-500 transition-all shadow-lg shadow-indigo-200 dark:shadow-none">
            <i class="fas fa-search-plus mr-2 text-xs"></i> Open Case File
        </a>
    </div>
</div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="logic">
    <div class="rounded-3xl h-44 mb-6 bg-slate-900 flex flex-col items-center justify-center text-white relative overflow-hidden border border-emerald-500/30">
        <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#10b981 1px, transparent 1px); background-size: 15px 15px;"></div>
        <div class="z-10 flex gap-2 mb-2">
            <div class="w-8 h-8 rounded bg-emerald-500/20 border border-emerald-500 flex items-center justify-center mono text-emerald-500 font-bold">2</div>
            <div class="w-8 h-8 rounded bg-emerald-500/20 border border-emerald-500 flex items-center justify-center mono text-emerald-500 font-bold">6</div>
            <div class="w-8 h-8 rounded bg-emerald-500/20 border border-emerald-500 flex items-center justify-center mono text-emerald-400 font-bold">?</div>
        </div>
        <i class="fas fa-brain text-4xl text-emerald-500 z-10 drop-shadow-[0_0_15px_rgba(16,185,129,0.4)]"></i>
        <div class="z-10 mt-3 mono text-[9px] font-black text-emerald-500 uppercase tracking-[0.4em]">Protocol Sigma</div>
    </div>
    <div class="px-2">
        <span class="text-[10px] font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-widest bg-emerald-50 dark:bg-emerald-900/20 px-3 py-1 rounded-full">Reasoning Trap</span>
        <h3 class="text-2xl font-bold mt-3 mb-2">Pattern Detective</h3>
        <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2 leading-relaxed">Detect shifting logic protocols. You must identify the number AND the rule to verify the sequence.</p>
        <a href="sequence.html" class="flex items-center justify-center w-full py-4 bg-emerald-600 text-white rounded-2xl font-bold hover:bg-emerald-500 transition-all shadow-lg shadow-emerald-200 dark:shadow-none">
            <i class="fas fa-terminal mr-2 text-xs"></i> Initialize Decoder
        </a>
    </div>
</div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="algebra">
    <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-slate-900 to-emerald-900 flex flex-col items-center justify-center text-white relative overflow-hidden border border-emerald-500/30">
        <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#22c55e 1px, transparent 1px); background-size: 15px 15px;"></div>
        <i class="fas fa-vector-square text-6xl text-emerald-500 z-10 drop-shadow-[0_0_10px_rgba(34,197,94,0.5)]"></i>
        <div class="z-10 mt-2 mono text-[10px] font-bold text-emerald-400 uppercase tracking-[0.3em]">Protocol Alpha</div>
    </div>
    <div class="px-2">
        <span class="text-[10px] font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-widest bg-emerald-50 dark:bg-emerald-900/20 px-3 py-1 rounded-full">Quick Calculation</span>
        <h3 class="text-2xl font-bold mt-3 mb-2">Algebra Snake</h3>
        <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2 leading-relaxed">Solve linear equations to grow your snake. Avoid the wrong answers to prevent system corruption!</p>
        <a href="snake.html" class="flex items-center justify-center w-full py-4 bg-emerald-600 text-white rounded-2xl font-bold hover:bg-emerald-500 transition-all shadow-lg shadow-emerald-200 dark:shadow-none">
            <i class="fas fa-play mr-2 text-xs"></i> Initialize Game
        </a>
    </div>
</div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="stats">
    <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-indigo-500 to-emerald-500 flex items-center justify-center text-white relative overflow-hidden">
        <i class="fas fa-sync-alt text-6xl opacity-20 absolute animate-spin-slow"></i>
        <div class="z-10 text-center">
            <div class="text-xs font-black uppercase tracking-widest opacity-70">Vault Bridge</div>
            <div class="text-4xl font-black">PROBABILITY</div>
        </div>
    </div>
    <div class="px-2">
        <span class="text-[10px] font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-widest bg-indigo-50 dark:bg-indigo-900/20 px-3 py-1 rounded-full">Statistics</span>
        <h3 class="text-2xl font-bold mt-3 mb-2">Probability Vault</h3>
        <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2 leading-relaxed">Predict the odds and unlock the Vault.</p>
        <a href="probability.html" class="flex items-center justify-center w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold hover:bg-indigo-500 transition-all shadow-lg shadow-indigo-200">Test Your Luck</a>
    </div>
</div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="logic">
    <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-blue-900 to-black flex items-center justify-center text-white relative overflow-hidden">
        <i class="fas fa-trophy text-6xl text-amber-500 z-10 shadow-2xl"></i>
        <div class="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"></div>
    </div>
    <div class="px-2">
        <span class="text-[10px] font-bold text-amber-600 dark:text-amber-400 uppercase tracking-widest bg-amber-50 dark:bg-amber-900/20 px-3 py-1 rounded-full">Exam Prep</span>
        <h3 class="text-2xl font-bold mt-3 mb-2">Math Millionaire</h3>
        <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2 leading-relaxed">The ultimate WAEC objective test. Use your lifelines wisely to win ₦1,000,000!</p>
        <a href="millionaire.html" class="flex items-center justify-center w-full py-4 bg-slate-900 dark:bg-white dark:text-slate-900 text-white rounded-2xl font-bold hover:opacity-90 transition-all">Enter Hotseat</a>
    </div>
</div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="geometry">
    <div class="rounded-3xl h-44 mb-6 bg-slate-900 flex flex-col items-center justify-center text-white relative overflow-hidden border border-indigo-500/30">
        <div class="absolute inset-0 opacity-20" style="background-image: linear-gradient(#4f46e5 1px, transparent 1px), linear-gradient(90deg, #4f46e5 1px, transparent 1px); background-size: 20px 20px;"></div>
        <i class="fas fa-chart-line text-6xl text-indigo-500 z-10"></i>
    </div>
    <div class="px-2">
        <span class="text-[10px] font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-widest bg-indigo-50 dark:bg-indigo-900/20 px-3 py-1 rounded-full">IGCSE / WAEC</span>
        <h3 class="text-2xl font-bold mt-3 mb-2">Graph Master</h3>
        <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">Visualize linear equations. Plot the points and draw the perfect line.</p>
        <a href="graphs.html" class="flex items-center justify-center w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold hover:bg-indigo-500 transition-all">Draw Graph</a>
    </div>
</div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="arithmetic">
    <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-emerald-400 to-cyan-500 flex flex-col items-center justify-center text-white relative overflow-hidden">
        <div class="text-4xl font-mono font-bold z-10">¾ vs ⅚</div>
        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
    </div>
    <div class="px-2">
        <span class="text-[10px] font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-widest bg-emerald-50 dark:bg-emerald-900/20 px-3 py-1 rounded-full">New Release</span>
        <h3 class="text-2xl font-bold mt-3 mb-2">Fraction Frenzy</h3>
        <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">Visual comparison and arithmetic battle. Master the number line!</p>
        <a href="fractions.html" class="flex items-center justify-center w-full py-4 bg-emerald-600 text-white rounded-2xl font-bold hover:bg-emerald-500 transition-all shadow-lg shadow-emerald-200 dark:shadow-none">Play Blitz</a>
    </div>
</div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="geometry">
    <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-indigo-900 to-black flex items-center justify-center text-white relative overflow-hidden">
        <div class="absolute w-32 h-32 border-4 border-dashed border-amber-500/30 rounded-full"></div>
        <i class="fas fa-bullseye text-6xl text-amber-500 z-10 animate-pulse"></i>
    </div>
    <div class="px-2">
        <span class="text-[10px] font-bold text-amber-600 dark:text-amber-400 uppercase tracking-widest bg-amber-50 dark:bg-amber-900/20 px-3 py-1 rounded-full">Arcade Math</span>
        <h3 class="text-2xl font-bold mt-3 mb-2">Target Practice</h3>
        <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">Hunt for missing angles! Pop the bubbles that solve the geometric proof.</p>
        <a href="geometry.html" class="flex items-center justify-center w-full py-4 bg-amber-600 text-white rounded-2xl font-bold hover:bg-amber-500 transition-all">Start Hunting</a>
    </div>
</div>
            
            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="arithmetic">
                <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-yellow-400 to-orange-600 flex flex-col items-center justify-center text-white relative overflow-hidden">
                    <i class="fas fa-bolt text-6xl z-10 opacity-90 animate-pulse"></i>
                    <div class="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/circuit-board.png')]"></div>
                </div>
                <div class="px-2">
                    <span class="text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase tracking-widest bg-orange-50 dark:bg-orange-900/20 px-3 py-1 rounded-full">UTME / WAEC Prep</span>
                    <h3 class="text-2xl font-bold mt-3 mb-2">Speed Arithmetic</h3>
                    <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">60 seconds on the clock. How many operations can you solve accurately?</p>
                    <a href="speed.html" class="flex items-center justify-center w-full py-4 bg-orange-600 text-white rounded-2xl font-bold hover:bg-orange-500 transition-all shadow-lg shadow-orange-200 dark:shadow-none">Start Blitz</a>
                </div>
            </div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="logic">
                <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-indigo-600 to-purple-700 flex flex-col items-center justify-center text-white relative overflow-hidden">
                    <i class="fas fa-brain text-6xl z-10 opacity-90"></i>
                    <div class="absolute top-2 right-4 text-4xl opacity-10 font-bold">∑</div>
                    <div class="absolute bottom-2 left-4 text-4xl opacity-10 font-bold">√</div>
                </div>
                <div class="px-2">
                    <span class="text-[10px] font-bold text-purple-600 dark:text-purple-400 uppercase tracking-widest bg-purple-50 dark:bg-purple-900/20 px-3 py-1 rounded-full">Cognitive Math</span>
                    <h3 class="text-2xl font-bold mt-3 mb-2">Memory Pro</h3>
                    <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">Match complex math problems with their answers before the "Memory Burn" kicks in!</p>
                    <a href="memory.html" class="flex items-center justify-center w-full py-4 bg-purple-600 text-white rounded-2xl font-bold hover:bg-purple-500 transition-all shadow-lg shadow-purple-200 dark:shadow-none">Play Memory</a>
                </div>
            </div>
            
            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="arithmetic">
                <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-cyan-400 to-blue-600 flex flex-col items-center justify-center text-white relative overflow-hidden">
                    <span class="text-6xl z-10 font-bold">÷</span>
                </div>
                <div class="px-2">
                    <span class="text-[10px] font-bold text-blue-600 dark:text-blue-400 uppercase tracking-widest bg-blue-50 dark:bg-blue-900/20 px-3 py-1 rounded-full">Number Theory</span>
                    <h3 class="text-2xl font-bold mt-3 mb-2">Divisibility Rules</h3>
                    <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">Master mental math shortcuts for speed and accuracy.</p>
                    <a href="divisiblity.html" class="flex items-center justify-center w-full py-4 bg-slate-900 dark:bg-white dark:text-slate-900 text-white rounded-2xl font-bold hover:opacity-90 transition-all">Play Now</a>
                </div>
            </div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="arithmetic">
                <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-red-500 to-indigo-600 flex items-center justify-center text-white overflow-hidden relative">
                    <i class="fas fa-hands-helping text-6xl opacity-80 rotate-12"></i>
                </div>
                <div class="px-2">
                    <span class="text-[10px] font-bold text-red-600 dark:text-red-400 uppercase tracking-widest bg-red-50 dark:bg-red-900/20 px-3 py-1 rounded-full">Arithmetic Battle</span>
                    <h3 class="text-2xl font-bold mt-3 mb-2">Tug of War</h3>
                    <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2 leading-relaxed">Fast-paced mental math battle. Pull the rope to your side!</p>
                    <a href="tugofwar.html" class="flex items-center justify-center w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold hover:bg-indigo-500 transition-all shadow-lg shadow-indigo-200">Enter Arena</a>
                </div>
            </div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="algebra">
                <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-emerald-400 to-teal-600 flex items-center justify-center text-white overflow-hidden relative">
                    <i class="fas fa-door-open text-6xl opacity-80"></i>
                </div>
                <div class="px-2">
                    <span class="text-[10px] font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-widest bg-emerald-50 dark:bg-emerald-900/20 px-3 py-1 rounded-full">Logic Puzzle</span>
                    <h3 class="text-2xl font-bold mt-3 mb-2">Escape Algebra</h3>
                    <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">Solve algebraic equations to unlock doors and find the exit.</p>
                    <a href="escapethedoor.html" class="flex items-center justify-center w-full py-4 bg-emerald-600 text-white rounded-2xl font-bold hover:bg-emerald-500 transition-all">Start Escape</a>
                </div>
            </div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="geometry">
                <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-indigo-500 to-sky-500 flex items-center justify-center text-white overflow-hidden">
                    <i class="fas fa-shapes text-6xl opacity-80"></i>
                </div>
                <div class="px-2">
                    <span class="text-[10px] font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-widest bg-indigo-50 dark:bg-indigo-900/20 px-3 py-1 rounded-full">Year 10 IGCSE</span>
                    <h3 class="text-2xl font-bold mt-3 mb-2">Geometry Proofs</h3>
                    <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">Master angle properties in triangles and parallel line logic.</p>
                    <a href="Geometry.html" class="flex items-center justify-center w-full py-4 bg-slate-900 dark:bg-white dark:text-slate-900 text-white rounded-2xl font-bold hover:opacity-90 transition-all">Play Now</a>
                </div>
            </div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="algebra">
                <div class="rounded-3xl h-44 mb-6 bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white relative overflow-hidden">
                    <div class="text-2xl font-mono italic z-10">ax² + bx + c = 0</div>
                </div>
                <div class="px-2">
                    <span class="text-[10px] font-bold text-purple-600 dark:text-purple-400 uppercase tracking-widest bg-purple-50 dark:bg-purple-900/20 px-3 py-1 rounded-full">Algebra</span>
                    <h3 class="text-2xl font-bold mt-3 mb-2">Quadratic Equation</h3>
                    <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">Solve for 'x' using factorization or the formula.</p>
                    <a href="quadratic.html" class="flex items-center justify-center w-full py-4 bg-slate-900 dark:bg-white dark:text-slate-900 text-white rounded-2xl font-bold hover:opacity-90 transition-all">Play Game</a>
                </div>
            </div>

            <div class="game-card bg-white dark:bg-slate-900 rounded-[2.5rem] p-5 shadow-xl border border-slate-100 dark:border-slate-800" data-category="logic">
                <div class="rounded-3xl h-44 mb-6 bg-slate-900 flex items-center justify-center text-cyan-400 border border-slate-700 relative overflow-hidden">
                    <i class="fas fa-microchip text-6xl z-10"></i>
                </div>
                <div class="px-2">
                    <span class="text-[10px] font-bold text-cyan-600 dark:text-cyan-400 uppercase tracking-widest bg-cyan-50 dark:bg-cyan-900/20 px-3 py-1 rounded-full">Further Maths</span>
                    <h3 class="text-2xl font-bold mt-3 mb-2">Flowchart Logic</h3>
                    <p class="text-slate-500 dark:text-slate-400 text-sm mb-6 line-clamp-2">Analyze algorithms and iterative math loops.</p>
                    <a href="loop.html" class="flex items-center justify-center w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold hover:bg-indigo-500 transition-all">Solve Algorithms</a>
                </div>
            </div>
        </div>

        <div id="noResults" class="hidden text-center py-20">
            <i class="fas fa-search text-4xl text-slate-300 mb-4"></i>
            <h3 class="text-xl font-bold text-slate-500">No matching challenges found.</h3>
        </div>
    </main>

    <script>
        function toggleMenu() {
            const menu = document.getElementById('mobile-menu');
            const overlay = document.getElementById('menu-overlay');
            const isOpen = !menu.classList.contains('translate-x-full');
            if (isOpen) {
                menu.classList.add('translate-x-full');
                overlay.classList.add('hidden');
                document.body.style.overflow = '';
            } else {
                menu.classList.remove('translate-x-full');
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        }

        function toggleDarkMode() {
            const html = document.documentElement;
            const icon = document.getElementById('theme-icon');
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                icon.className = 'fas fa-moon';
                localStorage.theme = 'light';
            } else {
                html.classList.add('dark');
                icon.className = 'fas fa-sun';
                localStorage.theme = 'dark';
            }
        }

        const loginGate = document.getElementById('loginGate');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const loginUsername = document.getElementById('loginUsername');
        const loginPassword = document.getElementById('loginPassword');
        const signupEmail = document.getElementById('signupEmail');
        const signupUsername = document.getElementById('signupUsername');
        const signupPassword = document.getElementById('signupPassword');
        const signupConfirmPassword = document.getElementById('signupConfirmPassword');
        const authError = document.getElementById('authError');
        const showLoginBtn = document.getElementById('showLoginBtn');
        const showSignupBtn = document.getElementById('showSignupBtn');
        const SESSION_KEY = 'mathPortalSession';
        const PLAYER_KEY = 'mathPortalPlayer';
        const USERS_KEY = 'mathPortalUsers';
        const desktopSearch = document.getElementById('gameSearch');
        const mobileSearch = document.getElementById('mobileSearch');
        const cards = document.querySelectorAll('.game-card');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const noResults = document.getElementById('noResults');
        const leaderboardList = document.getElementById('leaderboardList');
        const aiPredictionList = document.getElementById('aiPredictionList');
        const menuOverlay = document.getElementById('menu-overlay');
        const openMenuBtn = document.getElementById('open-menu-btn');
        const closeMenuBtn = document.getElementById('close-menu-btn');
        const themeToggleBtn = document.getElementById('theme-toggle-btn');
        let activeCategory = 'all';


        function showAuthError(message) {
            authError.textContent = message;
            authError.classList.remove('hidden');
        }

        function clearAuthError() {
            authError.textContent = '';
            authError.classList.add('hidden');
        }

        function normalizePlayerName(rawName) {
            return rawName.replace(/\s+/g, ' ').trim();
        }

        function validateUsername(rawName) {
            const username = normalizePlayerName(rawName);
            if (username.length < 3) {
                return { valid: false, username, message: 'Username must be at least 3 characters.' };
            }
            if (username.length > 24) {
                return { valid: false, username, message: 'Username must be 24 characters or fewer.' };
            }
            if (!/^[a-zA-Z0-9 _-]+$/.test(username)) {
                return { valid: false, username, message: 'Use only letters, numbers, spaces, underscore, or hyphen.' };
            }
            return { valid: true, username };
        }

        function getUsers() {
            try {
                const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
                return Array.isArray(users) ? users : [];
            } catch (error) {
                return [];
            }
        }

        function saveUsers(users) {
            localStorage.setItem(USERS_KEY, JSON.stringify(users));
        }

        function setAuthMode(mode) {
            clearAuthError();
            const inLogin = mode === 'login';
            loginForm.classList.toggle('hidden', !inLogin);
            signupForm.classList.toggle('hidden', inLogin);
            showLoginBtn.classList.toggle('bg-white', inLogin);
            showLoginBtn.classList.toggle('dark:bg-slate-700', inLogin);
            showLoginBtn.classList.toggle('text-indigo-600', inLogin);
            showSignupBtn.classList.toggle('bg-white', !inLogin);
            showSignupBtn.classList.toggle('dark:bg-slate-700', !inLogin);
            showSignupBtn.classList.toggle('text-indigo-600', !inLogin);
        }

        function unlockPortal(playerName) {
            document.body.classList.remove('locked');
            loginGate.classList.add('hidden');
            localStorage.setItem(PLAYER_KEY, playerName);
            sessionStorage.setItem(SESSION_KEY, 'active');
            renderLeaderboard();
            renderAiPredictions();
        }

        loginForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const usernameCheck = validateUsername(loginUsername.value);
            if (!usernameCheck.valid) {
                showAuthError(usernameCheck.message);
                return;
            }
            if ((loginPassword.value || '').trim().length < 6) {
                showAuthError('Password must be at least 6 characters.');
                return;
            }

            const users = getUsers();
            const user = users.find((entry) => entry.username.toLowerCase() === usernameCheck.username.toLowerCase());
            if (!user || user.password !== loginPassword.value) {
                showAuthError('Invalid username or password.');
                return;
            }
            clearAuthError();
            unlockPortal(user.username);
        });

        signupForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const usernameCheck = validateUsername(signupUsername.value);
            if (!usernameCheck.valid) {
                showAuthError(usernameCheck.message);
                return;
            }
            if (!signupEmail.value.trim() || !signupEmail.value.includes('@')) {
                showAuthError('Enter a valid email address.');
                return;
            }
            if (signupPassword.value.length < 6) {
                showAuthError('Password must be at least 6 characters.');
                return;
            }
            if (signupPassword.value !== signupConfirmPassword.value) {
                showAuthError('Passwords do not match.');
                return;
            }

            const users = getUsers();
            const alreadyExists = users.some((entry) => entry.username.toLowerCase() === usernameCheck.username.toLowerCase());
            if (alreadyExists) {
                showAuthError('That username is already registered. Please login instead.');
                return;
            }

            users.push({
                email: signupEmail.value.trim().toLowerCase(),
                username: usernameCheck.username,
                password: signupPassword.value
            });
            saveUsers(users);
            clearAuthError();
            unlockPortal(usernameCheck.username);
        });

        [loginUsername, loginPassword, signupEmail, signupUsername, signupPassword, signupConfirmPassword].forEach((input) => {
            input.addEventListener('input', () => {
                if (!authError.classList.contains('hidden')) clearAuthError();
            });
        });

        showLoginBtn.addEventListener('click', () => setAuthMode('login'));
        showSignupBtn.addEventListener('click', () => setAuthMode('signup'));

        function extractHighScore(slug) {
            const exactKey = `${slug}-highscore`;
            const values = [];

            const pushNumber = (value) => {
                const n = Number(value);
                if (!Number.isNaN(n) && Number.isFinite(n)) values.push(n);
            };

            pushNumber(localStorage.getItem(exactKey));

            const legacyMap = {
                speed: 'arithmetic_ranks',
                escapethedoor: 'math_ranks',
                memory: 'memory_speed_scores'
            };

            const legacyKey = legacyMap[slug];
            if (legacyKey) {
                try {
                    const parsed = JSON.parse(localStorage.getItem(legacyKey) || '[]');
                    parsed.forEach((item) => {
                        if (typeof item === 'number') pushNumber(item);
                        if (item && typeof item === 'object') {
                            pushNumber(item.s);
                            pushNumber(item.score);
                        }
                    });
                } catch (error) {
                    // ignore malformed old storage
                }
            }

            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const normalizedKey = key.toLowerCase();
                if (!normalizedKey.includes(slug) && normalizedKey !== exactKey) continue;
                if (!normalizedKey.includes('score')) continue;
                pushNumber(localStorage.getItem(key));
            }

            return values.length ? Math.max(...values) : 0;
        }

        function renderLeaderboard() {
            const scores = [...cards].map((card) => {
                const title = card.querySelector('h3').innerText.trim();
                const href = card.querySelector('a').getAttribute('href');
                const slug = href.replace('.html', '').toLowerCase();
                return { title, score: extractHighScore(slug) };
            }).sort((a, b) => b.score - a.score).slice(0, 6);

            leaderboardList.innerHTML = scores.map((entry, index) => `
                <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 dark:bg-slate-800/50">
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 rounded-full bg-indigo-600 text-white flex items-center justify-center font-bold">${index + 1}</span>
                        <div>
                            <p class="font-bold">${entry.title}</p>
                            <p class="text-xs text-slate-500 dark:text-slate-400">Top performance</p>
                        </div>
                    </div>
                    <span class="text-lg font-black text-emerald-600">${entry.score || '—'}</span>
                </div>
            `).join('');
        }

        function buildPrediction(title, category) {
            const categoryHints = {
                arithmetic: 'prioritize speed rounds, begin with easiest operators, and use estimation before committing.',
                algebra: 'predict variable isolation steps, keep coefficients balanced, and verify with substitution.',
                geometry: 'identify known angles first, map symmetry, and infer missing values from shape properties.',
                logic: 'eliminate impossible options early, track clues as constraints, and iterate with consistency checks.',
                stats: 'estimate likely outcomes first, then compare to exact probability formulas for precision.'
            };

            return `AI predicts that in ${title}, you should ${categoryHints[category] || 'break the challenge into smaller verified steps.'}`;
        }

        function renderAiPredictions() {
            const predictions = [...cards].map((card) => {
                const title = card.querySelector('h3').innerText.trim();
                const category = card.getAttribute('data-category');
                return `
                    <div class="p-3 rounded-2xl bg-indigo-50/80 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-900/30">
                        <p class="font-bold text-indigo-700 dark:text-indigo-300 mb-1">${title}</p>
                        <p class="text-slate-600 dark:text-slate-300">${buildPrediction(title, category)}</p>
                    </div>
                `;
            });

            aiPredictionList.innerHTML = predictions.join('');
        }

        function filterGames(category) {
            activeCategory = category;
            filterBtns.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.category === category) btn.classList.add('active');
            });
            applyFilters();
        }


        menuOverlay.addEventListener('click', toggleMenu);
        openMenuBtn.addEventListener('click', toggleMenu);
        closeMenuBtn.addEventListener('click', toggleMenu);
        themeToggleBtn.addEventListener('click', toggleDarkMode);
        filterBtns.forEach((button) => {
            button.addEventListener('click', () => filterGames(button.dataset.category));
        });

        [desktopSearch, mobileSearch].forEach(input => {
            input.addEventListener('input', (e) => {
                desktopSearch.value = e.target.value;
                mobileSearch.value = e.target.value;
                applyFilters();
            });
        });

        function applyFilters() {
            const searchTerm = desktopSearch.value.toLowerCase();
            let visibleCount = 0;
            cards.forEach(card => {
                const title = card.querySelector('h3').innerText.toLowerCase();
                const description = card.querySelector('p').innerText.toLowerCase();
                const category = card.getAttribute('data-category');
                const matchesSearch = title.includes(searchTerm) || description.includes(searchTerm);
                const matchesCategory = activeCategory === 'all' || category === activeCategory;
                if (matchesSearch && matchesCategory) {
                    card.classList.remove('hidden');
                    visibleCount++;
                } else {
                    card.classList.add('hidden');
                }
            });
            noResults.classList.toggle('hidden', visibleCount > 0);
        }

        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            document.getElementById('theme-icon').className = 'fas fa-sun';
        }

        setAuthMode('login');

        const existingPlayer = normalizePlayerName(localStorage.getItem(PLAYER_KEY) || '');
        const isSessionActive = sessionStorage.getItem(SESSION_KEY) === 'active';
        if (isSessionActive && existingPlayer && existingPlayer !== 'null' && existingPlayer !== 'undefined') {
            unlockPortal(existingPlayer);
        } else {
            document.body.classList.add('locked');
            loginGate.classList.remove('hidden');
        }
    </script>
</body>
</html>




















