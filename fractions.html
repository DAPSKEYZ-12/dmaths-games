<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fraction Frenzy | D-MATHS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=JetBrains+Mono:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: radial-gradient(circle at bottom left, #0f172a, #020617);
            color: white;
            min-height: 100vh;
        }

        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        
        /* Fraction UI */
        .fraction-container { display: flex; flex-direction: column; align-items: center; font-family: 'JetBrains Mono', monospace; }
        .numerator { border-bottom: 3px solid white; padding: 0 10px; font-size: 2.5rem; }
        .denominator { padding: 0 10px; font-size: 2.5rem; }

        /* Visual Bars */
        .f-bar-bg { width: 100%; height: 12px; background: rgba(255,255,255,0.1); border-radius: 6px; overflow: hidden; }
        .f-bar-fill { height: 100%; transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1); }

        .btn-action { transition: all 0.2s; border: 1px solid rgba(255,255,255,0.1); }
        .btn-action:active { transform: scale(0.95); }
        
        .multiplayer-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 640px) { .multiplayer-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body class="p-4">

    <a href="index.html" class="fixed top-6 left-6 z-50 bg-white/10 hover:bg-red-500/80 backdrop-blur-md border border-white/20 px-4 py-2 rounded-xl font-bold text-white transition-all flex items-center gap-2">
        <i class="fas fa-arrow-left"></i> <span>Hub</span>
    </a>

    <div class="max-w-4xl mx-auto pt-16">
        
        <div id="setup" class="glass rounded-[2.5rem] p-8 text-center shadow-2xl">
            <div class="w-20 h-20 bg-emerald-500 rounded-3xl flex items-center justify-center text-white text-4xl mx-auto mb-6 shadow-lg shadow-emerald-500/20">
                <i class="fas fa-percentage"></i>
            </div>
            <h1 class="text-4xl font-black mb-2">Fraction Frenzy</h1>
            <p class="text-slate-400 mb-8">Compare, solve, and dominate the number line.</p>
            
            <div class="flex flex-wrap justify-center gap-4 mb-8">
                <button onclick="setMode('solo')" id="mode-solo" class="px-8 py-3 rounded-2xl bg-emerald-600 font-bold">Solo Blitz</button>
                <button onclick="setMode('multi')" id="mode-multi" class="px-8 py-3 rounded-2xl bg-slate-800 font-bold hover:bg-slate-700">1v1 Local</button>
            </div>

            <button onclick="startGame()" class="w-full py-5 bg-white text-slate-950 rounded-2xl font-black text-xl hover:bg-emerald-400 transition-all">START GAME</button>
        </div>

        <div id="game" class="hidden">
            <div class="flex justify-between items-center mb-8 px-4">
                <div class="glass px-6 py-2 rounded-full font-bold">Score: <span id="score" class="text-emerald-400">0</span></div>
                <div id="timer-box" class="glass px-6 py-2 rounded-full font-bold text-orange-400">Time: <span id="timer">30</span>s</div>
            </div>

            <div class="glass rounded-[3rem] p-10 flex flex-col items-center relative overflow-hidden">
                <div class="flex items-center justify-around w-full mb-12">
                    <div class="flex flex-col items-center gap-4 w-1/3">
                        <div class="fraction-container" id="frac-a">
                            <div class="numerator">3</div>
                            <div class="denominator">4</div>
                        </div>
                        <div class="f-bar-bg"><div id="bar-a" class="f-bar-fill bg-emerald-500" style="width: 75%"></div></div>
                    </div>

                    <div class="text-4xl font-black text-slate-600" id="vs-icon">?</div>

                    <div class="flex flex-col items-center gap-4 w-1/3">
                        <div class="fraction-container" id="frac-b">
                            <div class="numerator">5</div>
                            <div class="denominator">6</div>
                        </div>
                        <div class="f-bar-bg"><div id="bar-b" class="f-bar-fill bg-blue-500" style="width: 83%"></div></div>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-4 w-full max-w-md">
                    <button onclick="checkAnswer('<')" class="btn-action glass py-6 rounded-2xl text-3xl hover:bg-white/10"><</button>
                    <button onclick="checkAnswer('=')" class="btn-action glass py-6 rounded-2xl text-3xl hover:bg-white/10">=</button>
                    <button onclick="checkAnswer('>')" class="btn-action glass py-6 rounded-2xl text-3xl hover:bg-white/10">></button>
                </div>
            </div>
        </div>

        <div id="results" class="hidden glass rounded-[2.5rem] p-12 text-center">
            <h2 class="text-5xl font-black mb-4">Time's Up!</h2>
            <p class="text-2xl text-emerald-400 mb-8">Final Score: <span id="final-score">0</span></p>
            <button onclick="location.reload()" class="px-10 py-4 bg-emerald-600 rounded-2xl font-bold">Try Again</button>
        </div>

    </div>

    <script>
        let gameState = {
            score: 0,
            timeLeft: 30,
            timer: null,
            mode: 'solo',
            currentFrac: { a: {}, b: {} }
        };

        function setMode(m) {
            gameState.mode = m;
            document.getElementById('mode-solo').className = m === 'solo' ? 'px-8 py-3 rounded-2xl bg-emerald-600 font-bold' : 'px-8 py-3 rounded-2xl bg-slate-800 font-bold';
            document.getElementById('mode-multi').className = m === 'multi' ? 'px-8 py-3 rounded-2xl bg-emerald-600 font-bold' : 'px-8 py-3 rounded-2xl bg-slate-800 font-bold';
        }

        function startGame() {
            document.getElementById('setup').classList.add('hidden');
            document.getElementById('game').classList.remove('hidden');
            nextQuestion();
            startTimer();
        }

        function nextQuestion() {
            // Generate random fractions
            const generateFrac = () => {
                const den = Math.floor(Math.random() * 9) + 2;
                const num = Math.floor(Math.random() * (den - 1)) + 1;
                return { num, den, val: num / den };
            };

            gameState.currentFrac.a = generateFrac();
            gameState.currentFrac.b = generateFrac();

            // Render
            updateFracUI('frac-a', 'bar-a', gameState.currentFrac.a);
            updateFracUI('frac-b', 'bar-b', gameState.currentFrac.b);
        }

        function updateFracUI(id, barId, data) {
            const el = document.getElementById(id);
            el.querySelector('.numerator').innerText = data.num;
            el.querySelector('.denominator').innerText = data.den;
            // Reveal bar slightly based on level? Or keep it hidden for harder logic?
            document.getElementById(barId).style.width = (data.val * 100) + "%";
        }

        function checkAnswer(choice) {
            const a = gameState.currentFrac.a.val;
            const b = gameState.currentFrac.b.val;
            let correct = false;

            if (choice === '<' && a < b) correct = true;
            if (choice === '>' && a > b) correct = true;
            if (choice === '=' && Math.abs(a - b) < 0.001) correct = true;

            if (correct) {
                gameState.score += 10;
                document.getElementById('score').innerText = gameState.score;
                // Visual feedback
                document.getElementById('vs-icon').innerText = choice;
                document.getElementById('vs-icon').className = "text-4xl font-black text-emerald-500 animate-bounce";
            } else {
                gameState.score = Math.max(0, gameState.score - 5);
                document.getElementById('score').innerText = gameState.score;
                document.getElementById('vs-icon').innerText = "âœ˜";
                document.getElementById('vs-icon').className = "text-4xl font-black text-red-500";
            }

            setTimeout(() => {
                document.getElementById('vs-icon').innerText = "?";
                document.getElementById('vs-icon').className = "text-4xl font-black text-slate-600";
                nextQuestion();
            }, 600);
        }

        function startTimer() {
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                document.getElementById('timer').innerText = gameState.timeLeft;
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timer);
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            document.getElementById('game').classList.add('hidden');
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('final-score').innerText = gameState.score;
        }

        // GCD for simplification logic (used for "Solve" mode upgrades)
        const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);
        const lcm = (a, b) => (a * b) / gcd(a, b);

    </script>
</body>
</html>
